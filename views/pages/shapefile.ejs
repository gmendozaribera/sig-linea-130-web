<!DOCTYPE html>
<html>

<head>
  <% include ../partials/header.ejs %>
  <link type="text/css" href="/css/leaflet.css" rel="stylesheet">
</head>

<body>

  <% include ../partials/nav.ejs %>

  <div class="jumbotron text-center" style="
      background-image: url('/img/website-header-blur-dark.jpg');
      background-repeat: no-repeat;
      background-size: 100%;">
    <div class="container">
      <a href="/" class="lang-logo">
        <img src="/lang-logo.png">
      </a>
      <h1>Gestión de la Linea de Micros 130</h1>
      <!--
      <p>Esta es una aplicación basada en el ejemplo de NodeJS de Heroku.</p>
      <a type="button" class="btn btn-lg btn-primary" href="/login"><span class="oi oi-account-login"></span> Iniciar sesión</a>
      <a type="button" class="btn btn-lg btn-secondary" href="/signup"><span class="oi oi-flash"></span> Crear una cuenta</a>
      -->
    </div>
  </div>

  <div class="container">

    <hr>

    <div class="row">
      <div class="col-lg-12">

        <!--
        <% if(typeof(geoJsonFeature) === "undefined" || geoJsonFeature == null){ %>
        <div class="alert alert-danger text-center" role="alert">
          <span class="oi oi-warning"></span><br>
          No se pudo cagar el shapefile :(
        </div>
        <% } %>
        -->

        <div class="card">
          <div class="card-body">
            <h5 class="card-title"><span class="oi oi-map" style="color: darkgreen"></span> Mapa</h5>
            <hr>
            <!-- el mapa Leaflet se renderiza aquí -->
            <div class="map" id="map" style="width: 100%; height: 500px"></div>
          </div>
        </div>
      </div>
    </div>

    <hr>


  </div> <!-- container -->
  <% include ../partials/footer.ejs %>


  <script type="text/javascript" src="/js/leaflet.js"></script>
  <script type="text/javascript" src="/js/geoJsonLoader.js"></script>
  <script>
    // establecer el mapa, pasandole el ID de un DIV en el cual se pueda dibujar
    const map = new L.Map('map');

    // crear la capa de imagenes de mapa con la atribución correcta
    const osmUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
    const osmAttrib = 'Datos de mapa © <a href="https://openstreetmap.org">OpenStreetMap</a> y contribuyentes';
    const osm = new L.TileLayer(osmUrl, { minZoom: 12, maxZoom: 19, attribution: osmAttrib });

    // iniciar el mapa centrado en la plaza 24 de septiembre, zoom nivel 12
    map.setView(new L.LatLng(-17.783318, -63.182120), 12);
    map.addLayer(osm);

    // --------------------- ajax request --------------------

    ajaxGetRequest('http://localhost:5000/get-geojson', (geoJson) => {
      L.geoJSON(geoJson.geometry).addTo(map);
    });

    /* TO DO:
    function cargarRutaIda() {

    }

    function cargarRutaVuelta() {

    }

    function cargarParadas() {


    }

    function cargarPuntosControl() {

    }
    */

  </script>
</body>

</html>